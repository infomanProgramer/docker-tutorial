## Entendiendo las capas de imagen

Las imágenes del contenedor se componen de capas. Y cada una de estas capas una vez creadas son inmutables. Pero que significa esto? y como esas capas usadas para crear archivos de sistema que un contenedor puede usar?

### Capas de Imagen

Cada capa de una imagen contiene un conjunto de cambios en el sistema de archivos: adiciones, eliminaciones o modificaciones. Veamos una imagen teórica:

1. La primera capa adiciona comandos basicos y un gestor de paquetes, tal como _apt_
2. La segunda capa instala un entorno de ejecución de Python y Pip para la gestión de dependencias
3. La tercera capa copia el archivo requirements.txt específico de una aplicación.
4. La cuarta capa intala dependencias especificas de la aplicación
5. La quinta capa copia en codigo fuente actual de la aplicación

![alt text](image-5.png)

Esto es benficioso por que permite a las capas ser reusadas entre imagenes. Por ejemplo imagina que quieres crear otro aplicación Python. Debido a la estratificación, puyedes aprovechar la misma base de Python. Esto hara contrucciones mas rapido y reducira el almacenamiento y ancho de banda requerido para distribuir las imagenes.

### Apilando las capas

La superposición es posible gracias al almacenamiento direccionable por contenido y a la unión de sistemas de archivos, asi es como funciona:

1. Después de descargar cada capa, se extrae en su propio directorio en el sistema de archivos del host.
2. Cuando ejecutas un contenedor desde una imagen, una union de archivos de sistema es creada donde las capas son apiladas una sobre otra, creando una nueva vista y unificada
3. Cuando un contenedor inicia, su directorio raíz se establece en la ubicación de este directorio unificado, utilizando chroot

Cuando la union de archivos de sistema es creado, adicionalmente a las capas de imagen un directorio es creado especialmente para el contenedor en ejecución. Esto permite que el contenedor realice cambios en el sistema de archivos mientras permite que las capas de la imagen original permanezcan intactas. Esto le permite ejecutar múltiples contenedores desde la misma imagen subyacente.
